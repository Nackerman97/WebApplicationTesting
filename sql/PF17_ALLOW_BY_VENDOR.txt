SET CURRENT QUERY ACCELERATION = ELIGIBLE;

SELECT 
DISTINCT HED.LOG, 
HED.VENDOR, 
HED.OFFER_NUMBER,
HED.ORDER_FROM_DATE,
HED.ORDER_TO_DATE,
HED.SHIP_FROM_DATE,
HED.SHIP_TO_DATE,
HED.ARRIVAL_FROM_DATE,
HED.ARRIVAL_TO_DATE,
COM.ALLOW_AMT,
COM.ALLOW_TYPE,
HED.VENDOR_NAME,
HED.MERCHANDISER,
HED.CREATION_DATE

--HEADER TYPE INFORMATION, INCLUDING INVOICE.
FROM SQLDAT3.WMALWHED HED

--ITEM LEVEL INFORMATION
JOIN SQLDAT3.WMALWCOM COM --ITEM LEVEL INFORMATION
ON COM.CORP = HED.CORP
AND COM.VENDOR = HED.VENDOR
AND COM.LOG = HED.LOG
AND COM.DIVISION = HED.DIVISION
AND COM.RES_DIVISION = HED.RES_DIVISION

--DETAIL LEVEL INFORMATION
LEFT JOIN SQLDAT3.WMALWDET DET
ON DET.CORP = HED.CORP
AND DET.VENDOR = HED.VENDOR
AND DET.LOG = HED.LOG
AND DET.RES_DIVISION = HED.RES_DIVISION

-- OPTIONAL: FOR GETTING THE SUM OF THE ITEM LEVEL INVOICE - SCAN
--LEFT JOIN SQLDATA.PAINVIIT IIT
--ON IIT.VENDOR = HED.VENDOR
--AND IIT.LOG = HED.LOG
--AND IIT.ITEM = COM.CORP_ITEM_CD
--AND IIT.AE_NBR = COM.ACCOUNTING_ENTITY
--AND IIT.VDC_DTE <> '11/11/1111' --PENDING AMOUNTS

WHERE 
COM.ITEM = '(&ITEM_NUM)'
--AND DET.UPC = '4178909201'
--AND COM.VENDOR = '84102'
--AND HED.LOG = '2021008'